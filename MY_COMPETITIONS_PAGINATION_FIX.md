# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ MESSAGE_TOO_LONG –≤ —Ä–∞–∑–¥–µ–ª–µ "–ú–æ–∏ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è"

## –î–∞—Ç–∞: 2025-12-19

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Ä–∞–∑–¥–µ–ª–∞ "‚úÖ –ú–æ–∏ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è" –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞:

```
ERROR: Telegram server says - Bad Request: MESSAGE_TOO_LONG
Message text length: 4365, competitions count: 37
```

**–ü—Ä–∏—á–∏–Ω–∞:** –§—É–Ω–∫—Ü–∏—è `show_my_competitions()` –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ –í–°–ï —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è. –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—ã–ª–æ 37 —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π, —á—Ç–æ –ø—Ä–∏–≤–µ–ª–æ –∫ –¥–ª–∏–Ω–µ —Å–æ–æ–±—â–µ–Ω–∏—è 4365 —Å–∏–º–≤–æ–ª–æ–≤, –ø—Ä–µ–≤—ã—à–∞—é—â–µ–π –ª–∏–º–∏—Ç Telegram (4096 —Å–∏–º–≤–æ–ª–æ–≤).

## –†–µ—à–µ–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏—è –≤ —Ä–∞–∑–¥–µ–ª "–ú–æ–∏ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è":
- **10 —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É**
- –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ "‚¨ÖÔ∏è –ù–∞–∑–∞–¥" / "–í–ø–µ—Ä–µ–¥ ‚û°Ô∏è"
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã "—Å—Ç—Ä. X/Y"

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### 1. –§—É–Ω–∫—Ü–∏—è `show_my_competitions()` - —Å—Ç—Ä–æ–∫–∏ 428-610

**–ë—ã–ª–æ:**
```python
async def show_my_competitions(callback: CallbackQuery, state: FSMContext):
    """–ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–±–µ–∑ –¥–µ–ª–µ–Ω–∏—è)"""

    competitions = await get_user_competitions(user_id, status_filter='upcoming')

    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –í–°–ï —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è (–±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ 10)
    for i, comp in enumerate(competitions, 1):
        ...
```

**–°—Ç–∞–ª–æ:**
```python
async def show_my_competitions(callback: CallbackQuery, state: FSMContext, page: int = 1):
    """–ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π"""

    all_competitions = await get_user_competitions(user_id, status_filter='upcoming')

    # Pagination - 10 competitions per page
    ITEMS_PER_PAGE = 10
    total_pages = (len(all_competitions) + ITEMS_PER_PAGE - 1) // ITEMS_PER_PAGE
    page = max(1, min(page, total_pages))  # Ensure page is within valid range

    start_idx = (page - 1) * ITEMS_PER_PAGE
    end_idx = start_idx + ITEMS_PER_PAGE
    competitions = all_competitions[start_idx:end_idx]

    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    for i, comp in enumerate(competitions, start_idx + 1):
        ...
```

**–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –Ω–æ–º–µ—Ä–æ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã:**
```python
# Show pagination info if there are multiple pages
if total_pages > 1:
    text = f"‚úÖ <b>–ú–û–ò –°–û–†–ï–í–ù–û–í–ê–ù–ò–Ø</b> (—Å—Ç—Ä. {page}/{total_pages})\n\n"
else:
    text = "‚úÖ <b>–ú–û–ò –°–û–†–ï–í–ù–û–í–ê–ù–ò–Ø</b>\n\n"
```

**–ö–Ω–æ–ø–∫–∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏:**
```python
# Pagination buttons
if total_pages > 1:
    pagination_buttons = []
    if page > 1:
        pagination_buttons.append(
            InlineKeyboardButton(text="‚¨ÖÔ∏è –ù–∞–∑–∞–¥", callback_data=f"comp:my_page:{page-1}")
        )
    pagination_buttons.append(
        InlineKeyboardButton(text=f"{page}/{total_pages}", callback_data="comp:my_noop")
    )
    if page < total_pages:
        pagination_buttons.append(
            InlineKeyboardButton(text="–í–ø–µ—Ä–µ–¥ ‚û°Ô∏è", callback_data=f"comp:my_page:{page+1}")
        )
    builder.row(*pagination_buttons)
```

### 2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ - —Å—Ç—Ä–æ–∫–∏ 613-623

–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏:

```python
@router.callback_query(F.data.startswith("comp:my_page:"))
async def my_competitions_pagination(callback: CallbackQuery, state: FSMContext):
    """Handle pagination for my competitions"""
    page = int(callback.data.split(":")[2])
    await show_my_competitions(callback, state, page=page)


@router.callback_query(F.data == "comp:my_noop")
async def my_competitions_noop(callback: CallbackQuery):
    """No-op callback for current page indicator"""
    await callback.answer()
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å —Ä–∞–∑–¥–µ–ª "‚úÖ –ú–æ–∏ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è" —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:

- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è **–º–∞–∫—Å–∏–º—É–º 10 —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π** –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- ‚úÖ –î–ª–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏–º–∏—Ç Telegram
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏ –∫–Ω–æ–ø–∫–∞–º–∏
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ç–µ–∫—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∏ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü
- ‚úÖ –ù—É–º–µ—Ä–∞—Ü–∏—è —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è (1-10, 11-20, 21-30, 31-37)

### –ü—Ä–∏–º–µ—Ä –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:

**–°—Ç—Ä–∞–Ω–∏—Ü–∞ 1:**
```
‚úÖ –ú–û–ò –°–û–†–ï–í–ù–û–í–ê–ù–ò–Ø (—Å—Ç—Ä. 1/4)

1. –ú–∞—Ä–∞—Ñ–æ–Ω –≤ –ú–æ—Å–∫–≤–µ
   üìè 42.2 –∫–º
   üìÖ 25.01.2026 (—á–µ—Ä–µ–∑ 37 –¥–Ω–µ–π)
   üéØ –¶–µ–ª—å: 03:30:00

2. –ü–æ–ª—É–º–∞—Ä–∞—Ñ–æ–Ω –≤ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–µ
   ...
10. –ó–∞–±–µ–≥ –≤ –ö–∞–∑–∞–Ω–∏
   ...

[1/4] [–í–ø–µ—Ä–µ–¥ ‚û°Ô∏è]
[‚óÄÔ∏è –ù–∞–∑–∞–¥]
```

**–°—Ç—Ä–∞–Ω–∏—Ü–∞ 4:**
```
‚úÖ –ú–û–ò –°–û–†–ï–í–ù–û–í–ê–ù–ò–Ø (—Å—Ç—Ä. 4/4)

31. –ó–∞–±–µ–≥ –≤ –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–µ
   ...
37. –ú–∞—Ä–∞—Ñ–æ–Ω –≤–æ –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫–µ
   ...

[‚¨ÖÔ∏è –ù–∞–∑–∞–¥] [4/4]
[‚óÄÔ∏è –ù–∞–∑–∞–¥]
```

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

1. **`competitions/competitions_handlers.py`**
   - **–°—Ç—Ä–æ–∫–∏ 428-448**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏—è –≤ —Ñ—É–Ω–∫—Ü–∏—é `show_my_competitions()`
   - **–°—Ç—Ä–æ–∫–∏ 481-485**: –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –Ω–æ–º–µ—Ä–æ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã
   - **–°—Ç—Ä–æ–∫–∏ 496-497**: –ù—É–º–µ—Ä–∞—Ü–∏—è —Å —É—á–µ—Ç–æ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã
   - **–°—Ç—Ä–æ–∫–∏ 573-587**: –ö–Ω–æ–ø–∫–∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
   - **–°—Ç—Ä–æ–∫–∏ 613-623**: –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π (–±–æ–ª–µ–µ 10)
2. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–∞–∑–¥–µ–ª "‚úÖ –ú–æ–∏ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è"
3. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è "—Å—Ç—Ä. 1/X" –∏ –∫–Ω–æ–ø–∫–∞ "–í–ø–µ—Ä–µ–¥ ‚û°Ô∏è"
4. –ù–∞–∂–º–∏—Ç–µ "–í–ø–µ—Ä–µ–¥ ‚û°Ô∏è" –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ 10 —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∫–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
6. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –Ω–µ—Ç –æ—à–∏–±–∫–∏ MESSAGE_TOO_LONG

---

‚úÖ **–ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞!**
