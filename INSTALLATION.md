# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏ –∑–∞–ø—É—Å–∫—É

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ï—Å–ª–∏ –≤—ã –æ–±–Ω–æ–≤–∏–ª–∏ –±–æ—Ç–∞ –∏ –¥–æ–±–∞–≤–∏–ª–∏ –º–æ–¥—É–ª—å "–ó–¥–æ—Ä–æ–≤—å–µ", –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é:

```bash
python migrate_health_table.py
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
–ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–∏...
OK - –¢–∞–±–ª–∏—Ü–∞ health_metrics —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞! (–∏–ª–∏ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã (13 –∫–æ–ª–æ–Ω–æ–∫):
  ...
–ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!
```

### 2. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```bash
python main.py
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –º–æ–¥—É–ª—è "–ó–¥–æ—Ä–æ–≤—å–µ"

1. –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **‚ù§Ô∏è –ó–¥–æ—Ä–æ–≤—å–µ**
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–Ω–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ: **üìù –í–Ω–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ** ‚Üí **‚úèÔ∏è –í–≤–µ—Å—Ç–∏ –≤—Å—ë**
4. –ü–æ—Å–ª–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–Ω–µ–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ **üò¥ –ê–Ω–∞–ª–∏–∑ —Å–Ω–∞**

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
trainingdairy_bot/
‚îú‚îÄ‚îÄ main.py                         # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ database.sqlite                 # –û—Å–Ω–æ–≤–Ω–∞—è –ë–î (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îú‚îÄ‚îÄ .env                           # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (BOT_TOKEN, DB_PATH)
‚îÇ
‚îú‚îÄ‚îÄ bot/                           # –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏ –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ handlers.py               # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ keyboards.py              # –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ fsm.py                    # FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îú‚îÄ‚îÄ health/                        # –ú–æ–¥—É–ª—å –∑–¥–æ—Ä–æ–≤—å—è ‚≠ê –ù–û–í–´–ô
‚îÇ   ‚îú‚îÄ‚îÄ health_handlers.py        # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ health_keyboards.py       # –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ health_fsm.py             # FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ health_queries.py         # –ó–∞–ø—Ä–æ—Å—ã –∫ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ health_graphs.py          # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ sleep_analysis.py         # –ê–Ω–∞–ª–∏–∑ —Å–Ω–∞
‚îÇ   ‚îî‚îÄ‚îÄ README.md                 # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–æ–¥—É–ª—è
‚îÇ
‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îú‚îÄ‚îÄ models.py                 # –°—Ö–µ–º—ã —Ç–∞–±–ª–∏—Ü (–≤–∫–ª—é—á–∞—è health_metrics)
‚îÇ   ‚îî‚îÄ‚îÄ queries.py                # CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
‚îÇ
‚îú‚îÄ‚îÄ notifications/
‚îÇ   ‚îî‚îÄ‚îÄ notification_scheduler.py # –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–æ–±–Ω–æ–≤–ª–µ–Ω–∞)
‚îÇ
‚îî‚îÄ‚îÄ migrate_health_table.py       # –ú–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç ‚≠ê –ù–û–í–´–ô
```

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —É–∂–µ —É–∫–∞–∑–∞–Ω—ã –≤ `requirements.txt`:

- **aiogram** - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –±–æ—Ç–∞
- **aiosqlite** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å SQLite
- **matplotlib** - –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤
- **pandas, numpy** - –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):
```bash
pip install -r requirements.txt
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

```env
BOT_TOKEN=your_bot_token_here
DB_PATH=database.sqlite
```

## –¢–∞–±–ª–∏—Ü–∞ health_metrics

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏):

```sql
CREATE TABLE health_metrics (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    date DATE NOT NULL,

    -- –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
    morning_pulse INTEGER,
    weight REAL,
    sleep_duration REAL,
    sleep_quality INTEGER,

    -- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ
    mood INTEGER,
    stress_level INTEGER,
    energy_level INTEGER,
    notes TEXT,

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (user_id) REFERENCES users(id),
    UNIQUE(user_id, date)
)
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "no such table: health_metrics"

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é
```bash
python migrate_health_table.py
```

### –û—à–∏–±–∫–∞ —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π –≤ Windows

**–†–µ—à–µ–Ω–∏–µ:** –ú–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç UTF-8 –¥–ª—è Windows

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫–Ω–æ–ø–∫—É "–ó–¥–æ—Ä–æ–≤—å–µ"

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
1. –†–æ—É—Ç–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω –≤ `main.py`: `dp.include_router(health_router)`
2. –ò–º–ø–æ—Ä—Ç –µ—Å—Ç—å: `from health.health_handlers import router as health_router`
3. –¢–∞–±–ª–∏—Ü–∞ —Å–æ–∑–¥–∞–Ω–∞: `python migrate_health_table.py`

### –ì—Ä–∞—Ñ–∏–∫–∏ –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
1. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω matplotlib: `pip install matplotlib`
2. –ï—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–µ—Ä–∏–æ–¥: –º–∏–Ω–∏–º—É–º 2-3 –¥–Ω—è

### –ê–Ω–∞–ª–∏–∑ —Å–Ω–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ú–∏–Ω–∏–º—É–º 3 –¥–Ω—è —Å –¥–∞–Ω–Ω—ã–º–∏ –æ —Å–Ω–µ
- –î–ª—è —Ç–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ 7-14 –¥–Ω–µ–π

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –±–æ—Ç–∞

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –∑–∞–ø—É—â–µ–Ω –±–æ—Ç:

1. **–û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞** (Ctrl+C)
2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é:**
   ```bash
   python migrate_health_table.py
   ```
3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:**
   ```bash
   python main.py
   ```

–í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ (—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏) —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è!

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–±–ª–∏—Ü –≤ –ë–î
```bash
python -c "import sqlite3; conn = sqlite3.connect('database.sqlite'); cursor = conn.cursor(); cursor.execute('SELECT name FROM sqlite_master WHERE type=\"table\"'); print([row[0] for row in cursor.fetchall()]); conn.close()"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã health_metrics
```bash
python -c "import sqlite3; conn = sqlite3.connect('database.sqlite'); cursor = conn.cursor(); cursor.execute('PRAGMA table_info(health_metrics)'); print([(col[1], col[2]) for col in cursor.fetchall()]); conn.close()"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö
```bash
python -c "import sqlite3; conn = sqlite3.connect('database.sqlite'); cursor = conn.cursor(); cursor.execute('SELECT COUNT(*) FROM health_metrics'); print(f'–ó–∞–ø–∏—Å–µ–π –≤ health_metrics: {cursor.fetchone()[0]}'); conn.close()"
```

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[health/README.md](health/README.md)** - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–æ–¥—É–ª—è
- **[HEALTH_USER_GUIDE.md](HEALTH_USER_GUIDE.md)** - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü –≤ –ë–î
4. –ò–∑—É—á–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤—ã—à–µ

---

**–ì–æ—Ç–æ–≤–æ! –ú–æ–¥—É–ª—å "–ó–¥–æ—Ä–æ–≤—å–µ" —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üí™**
