# Training Assistant - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

## ‚úÖ –ß—Ç–æ –≥–æ—Ç–æ–≤–æ

–ú–æ–¥—É–ª—å **Training Assistant** –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –±–æ—Ç–∞!

## üöÄ –ó–∞–ø—É—Å–∫

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API –∫–ª—é—á–∞

–î–æ–±–∞–≤—å—Ç–µ –≤ `.env` —Ñ–∞–π–ª:

```bash
OPENROUTER_API_KEY=your_key_here
```

–ü–æ–ª—É—á–∏—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫–ª—é—á: https://openrouter.ai/

### 2. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```bash
# –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
venv\Scripts\activate  # Windows
# –∏–ª–∏
source venv/bin/activate  # Linux/macOS

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
python main.py
```

### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–í –±–æ—Ç–µ:
- –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"ü§ñ Training Assistant"** –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é
- –ò–ª–∏ –∫–æ–º–∞–Ω–¥—É `/ai_assistant` –∏–ª–∏ `/ta`

## üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

1. **üìÖ –ü–ª–∞–Ω —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫** - AI —Å–æ–∑–¥–∞—Å—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –Ω–∞ –Ω–µ–¥–µ–ª—é –∏–ª–∏ –º–µ—Å—è—Ü
2. **üîÑ –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏** - AI –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏ –¥–∞—Å—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
3. **üèÜ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—é** - –°–æ–≤–µ—Ç—ã –∑–∞ 7/5/3/1 –¥–µ–Ω—å –¥–æ —Å—Ç–∞—Ä—Ç–∞
4. **üéØ –¢–∞–∫—Ç–∏–∫–∞ –∑–∞–±–µ–≥–∞** - –¢–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø–ª–∞–Ω —Å —Å–ø–ª–∏—Ç–∞–º–∏
5. **üß† –°–ø–æ—Ä—Ç–∏–≤–Ω—ã–π –ø—Å–∏—Ö–æ–ª–æ–≥** - –ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞
6. **üîÆ –ü—Ä–æ–≥–Ω–æ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞** - –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–≥–ª—É—à–∫–∏

–î–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ `database/queries.py`:

1. **get_personal_records_dict(user_id)**
   ```python
   async def get_personal_records_dict(user_id: int) -> dict:
       """–ü–æ–ª—É—á–∞–µ—Ç –ª–∏—á–Ω—ã–µ —Ä–µ–∫–æ—Ä–¥—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–∞–∫ —Å–ª–æ–≤–∞—Ä—å {distance: time}"""
       async with aiosqlite.connect(DB_PATH) as db:
           db.row_factory = aiosqlite.Row
           async with db.execute("""
               SELECT distance, best_time FROM personal_records
               WHERE user_id = ?
           """, (user_id,)) as cursor:
               rows = await cursor.fetchall()
               return {row['distance']: row['best_time'] for row in rows}
   ```

2. **get_user_competitions(user_id)**
   ```python
   async def get_user_competitions(user_id: int) -> list:
       """–ü–æ–ª—É—á–∞–µ—Ç —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
       async with aiosqlite.connect(DB_PATH) as db:
           db.row_factory = aiosqlite.Row
           async with db.execute("""
               SELECT c.*, p.distance, p.target_time, p.status
               FROM competitions c
               JOIN competition_participants p ON c.id = p.competition_id
               WHERE p.user_id = ?
               ORDER BY c.date
           """, (user_id,)) as cursor:
               rows = await cursor.fetchall()
               return [dict(row) for row in rows]
   ```

### –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∑–∞–≥–ª—É—à–∫–∏:

**training_assistant/ta_handlers.py:**
- –°—Ç—Ä–æ–∫–∞ 121: `personal_records = {}  # TODO`
- –°—Ç—Ä–æ–∫–∏ 322-326: –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π

## üîß –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –≤ database/queries.py

1. –û—Ç–∫—Ä–æ–π—Ç–µ `database/queries.py`
2. –î–æ–±–∞–≤—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã—à–µ –≤ –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
4. –£–±–µ—Ä–∏—Ç–µ TODO –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏–∑ `ta_handlers.py`
5. –û–±–Ω–æ–≤–∏—Ç–µ CHANGELOG.md

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π, –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ:

```bash
# –ü–ª–∞–Ω —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
/ai_assistant -> –ü–ª–∞–Ω —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ -> –≤—ã–±–µ—Ä–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

# –ü—Ä–æ–≥–Ω–æ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
/ai_assistant -> –ü—Ä–æ–≥–Ω–æ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ -> –≤–≤–µ–¥–∏—Ç–µ –¥–∏—Å—Ç–∞–Ω—Ü–∏—é
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```
INFO:training_assistant.services.plan_generator:Training plan generated for user 123
INFO:training_assistant.services.result_predictor:Result prediction generated for user 123
```

## üêõ Troubleshooting

### –û—à–∏–±–∫–∞: "AI client not configured"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `OPENROUTER_API_KEY` –≤ `.env`
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

### Rate limit (429)
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π retry –º–µ—Ö–∞–Ω–∏–∑–º –ø–æ–≤—Ç–æ—Ä–∏—Ç –∑–∞–ø—Ä–æ—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ü–æ–¥–æ–∂–¥–∏—Ç–µ 3-12 —Å–µ–∫—É–Ω–¥

### JSON parsing errors
- –ö–æ–¥ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- AI –≤–µ—Ä–Ω–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç–≤–µ—Ç –≤–º–µ—Å—Ç–æ JSON

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
python -m py_compile training_assistant/ta_handlers.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–ø–æ—Ä—Ç–∞
python -c "from training_assistant.ta_handlers import router; print('OK')"

# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
python main.py
```

–ï—Å–ª–∏ –≤—Å–µ OK - –º–æ–¥—É–ª—å –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

- –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `training_assistant/README.md`
- –ò–∑–º–µ–Ω–µ–Ω–∏—è: `CHANGELOG.md` (—Ä–∞–∑–¥–µ–ª 2026-02-03)
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: `CLAUDE.md` (–±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω)

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –≤ queries.py** (15 –º–∏–Ω—É—Ç)
2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ 6 —Ñ—É–Ω–∫—Ü–∏–π** (30 –º–∏–Ω—É—Ç)
3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—é AI** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
4. **–î–æ–±–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏–∑ –ø–ª–∞–Ω–æ–≤** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ì–æ—Ç–æ–≤–æ! üöÄ
