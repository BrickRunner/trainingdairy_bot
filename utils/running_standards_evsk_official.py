"""
Официальные нормативы ЕВСК по легкой атлетике (бег).
Источник: https://xn--b1afq1a.xn--p1ai/evsk/athletics_norm/
Только автохронометраж, стадион 400м.

МСМК выполняется с 16 лет; МС – с 15 лет;
КМС – с 14 лет; I-III спортивные разряды и юношеские спортивные разряды – с 10 лет
"""

from typing import List, Dict


def parse_time_to_seconds(time_str: str) -> float:
    """
    Конвертирует строку времени в секунды.

    Args:
        time_str: Строка времени (например "1:30:00", "15:30", "23.95", "1:00.84")

    Returns:
        Время в секундах
    """
    time_str = str(time_str).strip().replace(',', '.')

    # Формат ч.мин:с (например 1.01:52 = 1 час 01 минута 52 секунды)
    # НЕ путать с 1:00.84 (1 мин 0.84 сек)
    if time_str.count('.') == 1 and ':' in time_str:
        # Проверяем, это формат часов ч.мм:сс или минут мм:сс.дд
        dot_pos = time_str.index('.')
        colon_pos = time_str.index(':')

        # Если точка ДО двоеточия - это часы (1.01:52)
        if dot_pos < colon_pos:
            parts = time_str.split('.')
            hours = int(parts[0])
            time_parts = parts[1].split(':')
            minutes = int(time_parts[0])
            seconds = float(time_parts[1]) if len(time_parts) > 1 else 0
            return hours * 3600 + minutes * 60 + seconds
        # Иначе это минуты с долями секунд (1:00.84)
        else:
            parts = time_str.split(':')
            minutes = int(parts[0])
            seconds = float(parts[1])  # уже с точкой
            return minutes * 60 + seconds

    # Стандартный формат с :
    if ':' in time_str:
        parts = time_str.split(':')
        if len(parts) == 2:
            # MM:SS формат
            minutes = int(parts[0])
            seconds = float(parts[1])
            return minutes * 60 + seconds
        elif len(parts) == 3:
            # HH:MM:SS формат
            hours = int(parts[0])
            minutes = int(parts[1])
            seconds = float(parts[2])
            return hours * 3600 + minutes * 60 + seconds

    # Только секунды
    return float(time_str)


def get_official_running_standards() -> List[Dict]:
    """
    Возвращает официальные нормативы ЕВСК по бегу (автохронометраж, стадион 400м).

    Returns:
        Список нормативов с дистанцией, полом, разрядом и временем в секундах
    """
    standards = []

    # МУЖЧИНЫ - основные дистанции (автохронометраж)
    male_standards = {
        0.06: {  # 60м
            'МСМК': '6.63', 'МС': '6.83', 'КМС': '7.04',
            'I': '7.34', 'II': '7.64', 'III': '8.04',
            'I юн.': '8.44', 'II юн.': '8.94', 'III юн.': '9.44'
        },
        0.1: {  # 100м
            'МСМК': '10.15', 'МС': '10.62', 'КМС': '11.00',
            'I': '11.44', 'II': '12.04', 'III': '12.74',
            'I юн.': '13.54', 'II юн.': '14.44', 'III юн.': '15.44'
        },
        0.2: {  # 200м
            'МСМК': '20.51', 'МС': '21.41', 'КМС': '22.24',
            'I': '23.34', 'II': '24.64', 'III': '26.24',
            'I юн.': '28.24', 'II юн.': '30.74', 'III юн.': '34.24'
        },
        0.3: {  # 300м
            'КМС': '34.24', 'I': '36.54', 'II': '38.94', 'III': '41.94',
            'I юн.': '45.34', 'II юн.': '49.24', 'III юн.': '53.24'
        },
        0.4: {  # 400м (круг 400м)
            'МСМК': '45.35', 'МС': '47.13', 'КМС': '49.14',
            'I': '52.04', 'II': '55.84', 'III': '1:00.84',
            'I юн.': '1:06.24', 'II юн.': '1:11.24', 'III юн.': '1:17.24'
        },
        0.6: {  # 600м
            'КМС': '1:19.54', 'I': '1:23.74', 'II': '1:30.24', 'III': '1:37.24',
            'I юн.': '1:45.24', 'II юн.': '1:54.24', 'III юн.': '2:05.24'
        },
        0.8: {  # 800м (круг 400м)
            'МСМК': '1:46.20', 'МС': '1:49.39', 'КМС': '1:53.34',
            'I': '1:59.34', 'II': '2:08.24', 'III': '2:18.24',
            'I юн.': '2:30.24', 'II юн.': '2:43.24', 'III юн.': '2:57.24'
        },
        1.0: {  # 1000м
            'КМС': '2:28.24', 'I': '2:37.24', 'II': '2:49.24', 'III': '3:03.24',
            'I юн.': '3:18.24', 'II юн.': '3:35.24', 'III юн.': '3:54.24'
        },
        1.5: {  # 1500м (круг 400м)
            'МСМК': '3:36.94', 'МС': '3:46.11', 'КМС': '3:56.74',
            'I': '4:09.74', 'II': '4:25.24', 'III': '4:43.24',
            'I юн.': '5:03.24', 'II юн.': '5:28.24', 'III юн.': '5:58.24'
        },
        3.0: {  # 3000м (круг 400м)
            'МСМК': '7:52.94', 'МС': '8:07.13', 'КМС': '8:32.24',
            'I': '9:02.24', 'II': '9:42.24', 'III': '10:32.24',
            'I юн.': '11:22.24', 'II юн.': '12:17.24', 'III юн.': '13:22.24'
        },
        5.0: {  # 5000м
            'МСМК': '13:26.55', 'МС': '14:06.83', 'КМС': '14:50.24',
            'I': '15:45.24', 'II': '17:00.24', 'III': '18:20.24',
            'I юн.': '19:50.24', 'II юн.': '21:30.24'
        },
        10.0: {  # 10000м
            'МСМК': '27:55.71', 'МС': '29:19.50', 'КМС': '31:10.34',
            'I': '33:20.34', 'II': '35:50.34', 'III': '38:40.34'
        },
        15.0: {  # 15 км (шоссе)
            'КМС': '49:30', 'I': '53:00', 'II': '57:00', 'III': '1:01:30'
        },
        21.0975: {  # Полумарафон (шоссе)
            'МСМК': '1.01:52', 'МС': '1.06:30', 'КМС': '1.12:00',
            'I': '1.17:20', 'II': '1.22:35', 'III': '1.28:50'
        },
        42.195: {  # Марафон (шоссе)
            'МСМК': '2.14:00', 'МС': '2.22:00', 'КМС': '2.30:30',
            'I': '2.40:00', 'II': '2.50:00', 'III': '3.02:00'
        },
    }

    # ЖЕНЩИНЫ - основные дистанции (автохронометраж)
    female_standards = {
        0.06: {  # 60м
            'МСМК': '7.22', 'МС': '7.51', 'КМС': '7.84',
            'I': '8.14', 'II': '8.64', 'III': '9.14',
            'I юн.': '9.64', 'II юн.': '10.14', 'III юн.': '10.74'
        },
        0.1: {  # 100м
            'МСМК': '11.25', 'МС': '11.76', 'КМС': '12.34',
            'I': '13.04', 'II': '13.84', 'III': '14.54',
            'I юн.': '15.44', 'II юн.': '16.44', 'III юн.': '17.54'
        },
        0.2: {  # 200м
            'МСМК': '23.01', 'МС': '24.00', 'КМС': '25.34',
            'I': '26.74', 'II': '28.74', 'III': '30.74',
            'I юн.': '32.74', 'II юн.': '35.24', 'III юн.': '38.24'
        },
        0.3: {  # 300м
            'КМС': '40.34', 'I': '42.44', 'II': '44.64', 'III': '47.84',
            'I юн.': '50.54', 'II юн.': '53.74', 'III юн.': '57.44'
        },
        0.4: {  # 400м (круг 400м)
            'МСМК': '51.70', 'МС': '53.54', 'КМС': '56.44',
            'I': '59.94', 'II': '1:04.44', 'III': '1:10.24',
            'I юн.': '1:15.44', 'II юн.': '1:21.24', 'III юн.': '1:27.24'
        },
        0.6: {  # 600м (круг 400м)
            'КМС': '1:34.44', 'I': '1:39.44', 'II': '1:48.94', 'III': '1:58.24',
            'I юн.': '2:07.44', 'II юн.': '2:17.24', 'III юн.': '2:27.24'
        },
        0.8: {  # 800м (круг 400м)
            'МСМК': '2:00.77', 'МС': '2:04.39', 'КМС': '2:11.84',
            'I': '2:21.34', 'II': '2:33.34', 'III': '2:46.34',
            'I юн.': '2:59.34', 'II юн.': '3:13.34', 'III юн.': '3:29.34'
        },
        1.0: {  # 1000м (круг 400м)
            'КМС': '2:55.34', 'I': '3:07.24', 'II': '3:21.24', 'III': '3:37.24',
            'I юн.': '3:54.24', 'II юн.': '4:14.24', 'III юн.': '4:45.24'
        },
        1.5: {  # 1500м (круг 400м)
            'МСМК': '4:05.16', 'МС': '4:14.50', 'КМС': '4:36.34',
            'I': '4:57.34', 'II': '5:19.34', 'III': '5:44.34',
            'I юн.': '6:12.34', 'II юн.': '6:44.34', 'III юн.': '7:20.34'
        },
        3.0: {  # 3000м (круг 400м)
            'МСМК': '8:59.03', 'МС': '9:15.20', 'КМС': '10:00.34',
            'I': '10:55.34', 'II': '11:55.34', 'III': '13:00.34',
            'I юн.': '14:05.34', 'II юн.': '15:12.34', 'III юн.': '16:32.34'
        },
        5.0: {  # 5000м
            'МСМК': '15:21.88', 'МС': '16:07.05', 'КМС': '17:20.34',
            'I': '18:45.34', 'II': '20:20.34', 'III': '22:05.34',
            'I юн.': '24:00.34', 'II юн.': '26:05.34'
        },
        10.0: {  # 10000м
            'МСМК': '31:43.43', 'МС': '34:06.19', 'КМС': '37:00.34',
            'I': '40:00.34', 'II': '43:40.34', 'III': '47:50.34'
        },
        15.0: {  # 15 км (шоссе)
            'КМС': '59:00', 'I': '1.03:00', 'II': '1.08:00', 'III': '1.14:00'
        },
        21.0975: {  # Полумарафон (шоссе)
            'МСМК': '1.10:40', 'МС': '1.15:58', 'КМС': '1.25:00',
            'I': '1.35:00', 'II': '1.46:40', 'III': '2.00:00'
        },
        42.195: {  # Марафон (шоссе)
            'МСМК': '2.31:42', 'МС': '2.43:05', 'КМС': '3.00:00',
            'I': '3.25:00', 'II': '3.50:00', 'III': '4.15:00'
        },
    }

    # Конвертируем в список
    for distance, ranks in male_standards.items():
        for rank, time_str in ranks.items():
            standards.append({
                'distance': distance,
                'gender': 'male',
                'rank': rank,
                'time_seconds': parse_time_to_seconds(time_str)
            })

    for distance, ranks in female_standards.items():
        for rank, time_str in ranks.items():
            standards.append({
                'distance': distance,
                'gender': 'female',
                'rank': rank,
                'time_seconds': parse_time_to_seconds(time_str)
            })

    return standards


if __name__ == "__main__":
    # Тест
    standards = get_official_running_standards()
    print(f"Всего нормативов: {len(standards)}")

    # Примеры
    print("\nПримеры нормативов (мужчины, 21.0975 км):")
    for s in standards:
        if s['distance'] == 21.0975 and s['gender'] == 'male':
            minutes = int(s['time_seconds'] // 60)
            seconds = int(s['time_seconds'] % 60)
            print(f"  {s['rank']}: {minutes}:{seconds:02d} ({s['time_seconds']:.2f} сек)")
